@namespace UIComponents.DropDownMenu

<CascadingValue Value="this">
    <ul class="menu-root">
        @ChildContent
    </ul>
</CascadingValue>

@code {
    [CascadingParameter]
    private Menu Parent { get; set; }

    private List<MenuItem> MenuItemsList { get; set; }

    [Parameter]
    public RenderFragment ChildContent { get; set; }

    protected override void OnInitialized()
    {
        if (Parent == null) throw new ArgumentException(nameof(Parent), "MenuItems must be placed within a Menu component");
        base.OnInitialized();
        Parent.RegisterMenuItems(this);
        MenuItemsList = new List<MenuItem>();
    }

    internal void RegisterMenuItem(MenuItem menuItem)
    {
        MenuItemsList.Add(menuItem);
        StateHasChanged();
    }
}